function nu_CaTe = absortpioncoefficientCdTe(Xenergy)
% function nu_medium = absortpioncoefficientCdTe(Xenergy)
% Xenergy : X-ray energy in keV
% nu : linear absorption coefficient of CdTe in cm-1.


% mass attenuation coefficient, nu/rho of CdTe.
% Data from http://www.physics.nist.gov/PhysRefData/XrayMassCoef/ElemTab/z14.html
% Energy (MeV), the mass attenuation coefficient, ?/?, and the mass energy-absorption coefficient, ?en/?
dCad = 8.650; %g/cm
dTe = 6.240; %g/cm
Atw_Cd = 112.411;
Atw_Te = 127.6;

weightfraction_Cd = Atw_Cd/(Atw_Cd+Atw_Te);
weightfraction_Te = Atw_Te/(Atw_Cd+Atw_Te);

Cad = [1.00000E-03  7.350E+03  7.340E+03 
   1.50000E-03  2.931E+03  2.922E+03 
   2.00000E-03  1.473E+03  1.466E+03 
   3.00000E-03  5.414E+02  5.350E+02 
   3.53750E-03  3.575E+02  3.517E+02 
   3.53750E-03  1.152E+03  1.103E+03 
   3.63101E-03  1.083E+03  1.036E+03 
   3.72700E-03  1.013E+03  9.715E+02 
   3.72700E-03  1.389E+03  1.324E+03 
   4.00000E-03  1.170E+03  1.118E+03 
   4.01800E-03  1.157E+03  1.106E+03 
   4.01800E-03  1.324E+03  1.264E+03 
   5.00000E-03  7.685E+02  7.383E+02 
   6.00000E-03  4.793E+02  4.619E+02 
   8.00000E-03  2.254E+02  2.174E+02 
   1.00000E-02  1.244E+02  1.197E+02 
   1.50000E-02  4.178E+01  3.952E+01 
   2.00000E-02  1.920E+01  1.776E+01 
   2.67112E-02  8.809E+00  7.863E+00 
   2.67112E-02  5.065E+01  1.821E+01 
   3.00000E-02  3.765E+01  1.594E+01 
   4.00000E-02  1.778E+01  9.812E+00 
   5.00000E-02  9.779E+00  6.115E+00 
   6.00000E-02  5.975E+00  4.001E+00 
   8.00000E-02  2.751E+00  1.957E+00 
   1.00000E-01  1.524E+00  1.096E+00 
   1.50000E-01  5.593E-01  3.753E-01 
   2.00000E-01  3.038E-01  1.813E-01 
   3.00000E-01  1.571E-01  7.580E-02 
   4.00000E-01  1.129E-01  4.868E-02 
   5.00000E-01  9.250E-02  3.838E-02 
   6.00000E-01  8.064E-02  3.339E-02 
   8.00000E-01  6.670E-02  2.854E-02 
   1.00000E+00  5.826E-02  2.597E-02 
   1.25000E+00  5.129E-02  2.387E-02 
   1.50000E+00  4.673E-02  2.247E-02 
   2.00000E+00  4.139E-02  2.099E-02 
   3.00000E+00  3.698E-02  2.051E-02 
   4.00000E+00  3.559E-02  2.114E-02 
   5.00000E+00  3.536E-02  2.206E-02 
   6.00000E+00  3.563E-02  2.300E-02 
   8.00000E+00  3.691E-02  2.477E-02 
   1.00000E+01  3.853E-02  2.625E-02 
   1.50000E+01  4.253E-02  2.869E-02 
   2.00000E+01  4.587E-02  2.985E-02];

Te = [1.00000E-03  8.434E+03  8.419E+03 
   1.00300E-03  8.380E+03  8.365E+03 
   1.00600E-03  8.326E+03  8.311E+03 
   1.00600E-03  8.684E+03  8.668E+03 
   1.50000E-03  3.608E+03  3.598E+03 
   2.00000E-03  1.832E+03  1.824E+03 
   3.00000E-03  6.792E+02  6.726E+02 
   4.00000E-03  3.297E+02  3.240E+02 
   4.34140E-03  2.678E+02  2.625E+02 
   4.34140E-03  7.882E+02  7.460E+02 
   4.47465E-03  7.504E+02  7.078E+02 
   4.61200E-03  6.995E+02  6.629E+02 
   4.61200E-03  9.445E+02  8.880E+02 
   4.77280E-03  8.782E+02  8.237E+02 
   4.93920E-03  8.062E+02  7.600E+02 
   4.93920E-03  9.292E+02  8.744E+02 
   5.00000E-03  9.014E+02  8.487E+02 
   6.00000E-03  5.721E+02  5.423E+02 
   8.00000E-03  2.702E+02  2.578E+02 
   1.00000E-02  1.501E+02  1.433E+02 
   1.50000E-02  5.078E+01  4.802E+01 
   2.00000E-02  2.341E+01  2.175E+01 
   3.00000E-02  7.878E+00  6.997E+00 
   3.18138E-02  6.738E+00  5.929E+00 
   3.18138E-02  3.719E+01  1.251E+01 
   4.00000E-02  2.064E+01  9.480E+00 
   5.00000E-02  1.145E+01  6.330E+00 
   6.00000E-02  7.041E+00  4.306E+00 
   8.00000E-02  3.255E+00  2.195E+00 
   1.00000E-01  1.801E+00  1.256E+00 
   1.50000E-01  6.492E-01  4.409E-01 
   2.00000E-01  3.429E-01  2.132E-01 
   3.00000E-01  1.679E-01  8.646E-02 
   4.00000E-01  1.163E-01  5.326E-02 
   5.00000E-01  9.328E-02  4.055E-02 
   6.00000E-01  8.022E-02  3.440E-02 
   8.00000E-01  6.538E-02  2.854E-02 
   1.00000E+00  5.669E-02  2.559E-02 
   1.25000E+00  4.967E-02  2.327E-02 
   1.50000E+00  4.518E-02  2.179E-02 
   2.00000E+00  4.009E-02  2.033E-02 
   3.00000E+00  3.606E-02  1.998E-02 
   4.00000E+00  3.494E-02  2.075E-02 
   5.00000E+00  3.492E-02  2.177E-02 
   6.00000E+00  3.534E-02  2.279E-02 
   8.00000E+00  3.683E-02  2.466E-02 
   1.00000E+01  3.860E-02  2.620E-02 
   1.50000E+01  4.290E-02  2.873E-02 
   2.00000E+01  4.642E-02  2.989E-02];

% Density of CdTe
d = 6.20; % g/cm3 at RT;
Cad(:,1) = Cad(:,1)*1000; %MeV to keV;
[~, ind] = min(abs(Cad(:,1)-Xenergy));
nu_Ca = interp1(Cad(ind-1:ind+1,1), Cad(ind-1:ind+1, 2), Xenergy);
Te(:,1) = Te(:,1)*1000; %MeV to keV;
[~, ind] = min(abs(Te(:,1)-Xenergy));
nu_Te = interp1(Te(ind-1:ind+1,1), Te(ind-1:ind+1, 2), Xenergy);
nu_CaTe = weightfraction_Cd*nu_Ca + weightfraction_Te*nu_Te;
nu_CaTe = nu_CaTe*d;